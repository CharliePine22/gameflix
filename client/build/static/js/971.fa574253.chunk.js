"use strict";(self.webpackChunkgameflix=self.webpackChunkgameflix||[]).push([[971],{7055:function(e,n,t){t.r(n),t.d(n,{default:function(){return m}});var a=t(4165),r=t(5861),s=t(9439),u=t(2791),c=t(7689),i=t.p+"static/media/vg-collage.acd91def3e862094d9e0.jpg",o=t(184),l=function(e){var n,t,c,l,p=e.toLanding,d=e.authenticateUser,f=(0,u.useState)(!1),m=(0,s.Z)(f,2),g=m[0],v=m[1],h=(0,u.useState)(!1),_=(0,s.Z)(h,2),x=_[0],j=_[1],w=(0,u.useState)(null),b=(0,s.Z)(w,2),Z=b[0],N=b[1],k=(0,u.useState)(""),S=(0,s.Z)(k,2),y=S[0],C=S[1],L=(0,u.useState)(!1),D=(0,s.Z)(L,2),F=D[0],I=D[1];document.body.style.overflow="hidden";var z=(0,u.useRef)(""),E=(0,u.useRef)(""),R=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,A=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(n){var t,r,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),I(!0),t=z.current.value,r=E.current.value,z.current.blur(),E.current.blur(),N(""),e.next=9,d(t,r);case 9:(s=e.sent).data||C(s),I(!1);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,o.jsxs)("div",{className:"login__wrapper",children:[(0,o.jsx)("div",{className:"login",children:(0,o.jsx)("div",{className:"login__form_wrapper",children:(0,o.jsx)("div",{className:"login__form_container",children:(0,o.jsx)("form",{className:"login__form",onSubmit:A,children:F?(0,o.jsx)("div",{className:"login__loading",children:(0,o.jsx)("div",{className:"loading_spinner"})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h1",{children:"LOGIN"}),(0,o.jsxs)("div",{className:"login__form_actions",children:[(0,o.jsx)("label",{className:"form_label",htmlFor:"email"}),(0,o.jsx)("input",{ref:z,onFocus:function(){return N("email")},onChange:function(e){g&&v(!1);var n=e.target.value.trim().toLowerCase();R.test(n)},onBlur:function(e){var n=e.target.value.trim().toLowerCase(),t=R.test(n);v(!t),N(null)},className:"form_input ".concat(""!==(null===(n=z.current)||void 0===n?void 0:n.value)&&g?"error":""),type:"email"}),(0,o.jsx)("span",{className:"form_actions_placeholder ".concat(null!==(t=z.current)&&void 0!==t&&t.value||"email"==Z?"focused":""),children:"Email"})]}),(0,o.jsxs)("div",{className:"login__form_actions",children:[(0,o.jsx)("label",{className:"form_label",htmlFor:"email"}),(0,o.jsx)("input",{ref:E,onFocus:function(){return N("password")},onChange:function(e){x&&j(!1);e.target.value.trim().toLowerCase(),e.target.value.length>0&&e.target.value.length},onBlur:function(e){var n=e.target.value.trim().toLowerCase(),t=n.length>3&&n.length<=8;j(!t),N(null)},className:"form_input ".concat(void 0!==(null===(c=E.current)||void 0===c?void 0:c.value)&&x&&E.current.value.length>0?"error":""),type:"password"}),(0,o.jsx)("span",{className:"form_actions_placeholder ".concat(null!==(l=E.current)&&void 0!==l&&l.value||"password"==Z?"password_focused":""),children:"Password"}),y&&(0,o.jsx)("p",{className:"login__auth_error",children:y})]}),(0,o.jsx)("button",{className:"form__submit_btn",children:"Sign In"}),(0,o.jsxs)("p",{className:"form__create_account",children:["Don't have an account?"," ",(0,o.jsx)("span",{onClick:function(){p()},children:"Create one now"}),"."]})]})})})})}),(0,o.jsx)("div",{className:"login__background",children:(0,o.jsx)("img",{src:i})})]})},p=t(4569),d=t.n(p);var f=(0,u.lazy)((function(){return Promise.all([t.e(355),t.e(257),t.e(112),t.e(865)]).then(t.bind(t,5558))})),m=function(e){var n=e.onLogin,t=function(){var e=localStorage.getItem("twitch_auth"),n=(0,u.useState)([]),t=(0,s.Z)(n,2),c=t[0],i=t[1],o="https://gameflix.up.railway.app",l=new Date;(0,u.useEffect)((function(){var n=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d().get("".concat(o,"/authentication/login_banner"));case 2:if(n=e.sent,r=new Date(n.data.last_updated),!(l>r.setDate(r.getDate()+7))){e.next=9;break}return t(),e.abrupt("return");case 9:return i(n.data.popular_games_list),e.abrupt("return");case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n();var t=function(){var n=(0,r.Z)((0,a.Z)().mark((function n(){var t;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return n.prev=2,n.next=5,d().post("".concat(o,"/app/popular_titles"),{token:e});case 5:return t=n.sent,n.abrupt("return",p(t.data));case 9:return n.prev=9,n.t0=n.catch(2),console.log(n.t0),n.abrupt("return",n.t0);case 13:case"end":return n.stop()}}),n,null,[[2,9]])})));return function(){return n.apply(this,arguments)}}()}),[e]);var p=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d().post("".concat(o,"/authentication/update_login_banner"),{gameList:n,date:new Date});case 2:t=e.sent,i(t.data.popular_games_list);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return c}(),i=(0,u.useState)(!0),p=(0,s.Z)(i,2),m=(p[0],p[1]),g=(0,u.useState)(!1),v=(0,s.Z)(g,2),h=v[0],_=v[1],x=localStorage.getItem("user"),j=(0,c.s0)(),w=(0,u.useRef)(0);(0,u.useEffect)((function(){x&&j("/")}),[]);var b=function(){w.current+=1,w.current>=t.length&&m(!1)},Z=null===t||void 0===t?void 0:t.map((function(e){return(0,o.jsx)(u.Fragment,{children:(0,o.jsx)("img",{className:"login__img",src:"//images.igdb.com/igdb/image/upload/t_cover_big_2x/".concat(e.cover.image_id,".jpg"),onLoad:b})},e.id)})),N=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t,r){var s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d().post("".concat("https://gameflix.up.railway.app","/authentication/signin"),{email:t,password:r});case 3:return s=e.sent,n(s.data.user),e.abrupt("return",s);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0.response.data.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(n,t){return e.apply(this,arguments)}}();return x?(0,o.jsx)("div",{className:"auth_login__loading",children:(0,o.jsx)("div",{className:"auth_loading_spinner"})}):h?(0,o.jsx)(u.Suspense,{fallback:(0,o.jsx)(o.Fragment,{children:"..."}),children:(0,o.jsx)(f,{toSignIn:function(){_(!1)},images:Z})}):(0,o.jsx)(l,{toLanding:function(){return _(!0)},authenticateUser:function(e,n){return N(e,n)}})}}}]);
//# sourceMappingURL=971.fa574253.chunk.js.map